(function(c){var a=new Array();var b=new Array();c.fn.doAutosize=function(j){var g=c(this).data("minwidth"),q=c(this).data("maxwidth"),l="",p=c(this),k=c("#"+c(this).data("tester_id"));if(l===(l=p.val())){return}var f=l.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");k.html(f);var n=k.width(),m=(n+j.comfortZone)>=g?n+j.comfortZone:g,h=p.width(),e=(m<h&&m>=g)||(m>g&&m<q);if(e){p.width(m)}};c.fn.resetAutosize=function(g){var j=c(this).data("minwidth")||g.minInputWidth||c(this).width(),k=c(this).data("maxwidth")||g.maxInputWidth||(c(this).closest(".tagsinput").width()-g.inputPadding),l="",f=c(this),h=c("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:f.css("fontSize"),fontFamily:f.css("fontFamily"),fontWeight:f.css("fontWeight"),letterSpacing:f.css("letterSpacing"),whiteSpace:"nowrap"}),e=c(this).attr("id")+"_autosize_tester";if(!c("#"+e).length>0){h.attr("id",e);h.appendTo("body")}f.data("minwidth",j);f.data("maxwidth",k);f.data("tester_id",e);f.css("width",j)};c.fn.addTag=function(f,e){e=jQuery.extend({focus:false,callback:true},e);this.each(function(){var l=c(this).attr("id");var g=c(this).val().split(a[l]);if(g[0]==""){g=new Array()}f=jQuery.trim(f);if(e.unique){var h=c(this).tagExist(f);if(h==true){c("#"+l+"_tag").addClass("not_valid")}}else{var h=false}if(f!=""&&h!=true){c("<span>").addClass("tag").append(c("<span>").text(f).append("&nbsp;&nbsp;"),c("<a>",{href:"#",title:"Removing tag",text:"x"}).click(function(){return c("#"+l).removeTag(escape(f))})).insertBefore("#"+l+"_addTag");g.push(f);c("#"+l+"_tag").val("");if(e.focus){c("#"+l+"_tag").focus()}else{c("#"+l+"_tag").blur()}c.fn.tagsInput.updateTagsField(this,g);if(e.callback&&b[l]&&b[l]["onAddTag"]){var k=b[l]["onAddTag"];k.call(this,f)}if(b[l]&&b[l]["onChange"]){var j=g.length;var k=b[l]["onChange"];k.call(this,c(this),g[j-1])}}});return false};c.fn.removeTag=function(e){e=unescape(e);this.each(function(){var j=c(this).attr("id");var g=c(this).val().split(a[j]);c("#"+j+"_tagsinput .tag").remove();str="";for(i=0;i<g.length;i++){if(g[i]!=e){str=str+a[j]+g[i]}}c.fn.tagsInput.importTags(this,str);if(b[j]&&b[j]["onRemoveTag"]){var h=b[j]["onRemoveTag"];h.call(this,e)}});return false};c.fn.tagExist=function(g){var h=c(this).attr("id");var f=c(this).val().split(a[h]);var e=false;c.each(f,function(j,k){if(k.toLowerCase()===g.toLowerCase()){e=true;return false}});return e};c.fn.importTags=function(e){id=c(this).attr("id");c("#"+id+"_tagsinput .tag").remove();c.fn.tagsInput.importTags(this,e)};function d(e){this.culturesNames=new Array("ro","en-GB");this.defaultTextTranslation=new Array("adauga o eticheta","add a tag");for(i=0;i<this.culturesNames.length;++i){if(this.culturesNames[i]==e){return{cultureName:this.culturesNames[i],translation:this.defaultTextTranslation[i]}}}return{cultureName:"en_GB",translation:"add a tag"}}c.fn.tagsInput=function(e){var f=new d(window.app.calendarCulture);var g=jQuery.extend({interactive:true,defaultText:c(".filterLabel").val(),minChars:0,width:"300px",height:"100px",autocomplete:{selectFirst:false},hide:true,delimiter:",",unique:true,removeWithBackspace:true,placeholderColor:"#666666",autosize:true,comfortZone:20,inputPadding:6*2},e);this.each(function(){if(g.hide){c(this).hide()}var k=c(this).attr("id");if(!k||a[c(this).attr("id")]){k=c(this).attr("id","tags"+new Date().getTime()).attr("id")}var j=jQuery.extend({pid:k,real_input:"#"+k,holder:"#"+k+"_tagsinput",input_wrapper:"#"+k+"_addTag",fake_input:"#"+k+"_tag"},g);a[k]=j.delimiter;if(g.onAddTag||g.onRemoveTag||g.onChange){b[k]=new Array();b[k]["onAddTag"]=g.onAddTag;b[k]["onRemoveTag"]=g.onRemoveTag;b[k]["onChange"]=g.onChange}var h='<div id="'+k+'_tagsinput" class="tagsinput"><div id="'+k+'_addTag">';if(g.interactive){h=h+'<input id="'+k+'_tag" value="" data-default="'+g.defaultText+'" />'}h=h+'</div><div class="tags_clear"></div></div>';c(h).insertAfter(this);c(j.holder).css("width",g.width);c(j.holder).css("min-height",g.height);c(j.holder).css("height","100%");if(c(j.real_input).val()!=""){c.fn.tagsInput.importTags(c(j.real_input),c(j.real_input).val())}if(g.interactive){c(j.fake_input).val(c(j.fake_input).attr("data-default"));c(j.fake_input).css("color",g.placeholderColor);c(j.fake_input).resetAutosize(g);c(j.holder).bind("click",j,function(l){c(l.data.fake_input).focus()});c(j.fake_input).bind("focus",j,function(l){if(c(l.data.fake_input).val()==c(l.data.fake_input).attr("data-default")){c(l.data.fake_input).val("")}c(l.data.fake_input).css("color","#000000")});if(g.autocomplete_url!=undefined){autocomplete_options={source:g.autocomplete_url};for(attrname in g.autocomplete){autocomplete_options[attrname]=g.autocomplete[attrname]}if(jQuery.Autocompleter!==undefined){c(j.fake_input).autocomplete(g.autocomplete_url,g.autocomplete);c(j.fake_input).bind("result",j,function(l,n,m){if(n){c("#"+k).addTag(n[0]+"",{focus:true,unique:(g.unique)})}})}else{if(jQuery.ui.autocomplete!==undefined){c(j.fake_input).autocomplete(autocomplete_options);c(j.fake_input).bind("autocompleteselect",j,function(l,m){c(l.data.real_input).addTag(m.item.value,{focus:true,unique:(g.unique)});return false})}}}else{c(j.fake_input).bind("blur",j,function(l){var m=c(this).attr("data-default");if(c(l.data.fake_input).val()!=""&&c(l.data.fake_input).val()!=m){if((l.data.minChars<=c(l.data.fake_input).val().length)&&(!l.data.maxChars||(l.data.maxChars>=c(l.data.fake_input).val().length))){c(l.data.real_input).addTag(c(l.data.fake_input).val(),{focus:true,unique:(g.unique)})}}else{c(l.data.fake_input).val(c(l.data.fake_input).attr("data-default"));c(l.data.fake_input).css("color",g.placeholderColor)}return false})}c(j.fake_input).bind("keypress",j,function(l){if(l.which==l.data.delimiter.charCodeAt(0)||l.which==13){l.preventDefault();if((l.data.minChars<=c(l.data.fake_input).val().length)&&(!l.data.maxChars||(l.data.maxChars>=c(l.data.fake_input).val().length))){c(l.data.real_input).addTag(c(l.data.fake_input).val(),{focus:true,unique:(g.unique)})}c(l.data.fake_input).resetAutosize(g);return false}else{if(l.data.autosize){c(l.data.fake_input).doAutosize(g)}}});j.removeWithBackspace&&c(j.fake_input).bind("keydown",function(m){if(m.keyCode==8&&c(this).val()==""){m.preventDefault();var l=c(this).closest(".tagsinput").find(".tag:last").text();var n=c(this).attr("id").replace(/_tag$/,"");l=l.replace(/[\s]+x$/,"");c("#"+n).removeTag(escape(l));c(this).trigger("focus")}});c(j.fake_input).blur();if(j.unique){c(j.fake_input).keydown(function(l){if(l.keyCode==8||String.fromCharCode(l.which).match(/\w+|[áéíóúÁÉÍÓÚñÑ,/]+/)){c(this).removeClass("not_valid")}})}}});return this};c.fn.tagsInput.updateTagsField=function(f,e){var g=c(f).attr("id");c(f).val(e.join(a[g]))};c.fn.tagsInput.importTags=function(h,j){c(h).val("");var k=c(h).attr("id");var e=j.split(a[k]);for(i=0;i<e.length;i++){c(h).addTag(e[i],{focus:false,callback:false})}if(b[k]&&b[k]["onChange"]){var g=b[k]["onChange"];g.call(h,h,e[i])}}})(jQuery);