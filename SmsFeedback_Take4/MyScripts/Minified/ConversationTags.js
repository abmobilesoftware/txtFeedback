"use strict";var tagsRep={};function TagsArea(){var d=Backbone.Model.extend({defaults:{Name:"tag",Description:"description",},idAttribute:"Name"});var c=Backbone.Collection.extend({model:d,url:function(){return"Tags/GetTagsForConversation"}});var b={lines:9,length:5,width:3,radius:3,rotate:0,color:"black",speed:1,trail:60,shadow:true,hwaccel:false,className:"spinner",zIndex:2000000000,top:"auto",left:"auto"};var f=new Spinner(b);var e=Backbone.View.extend({el:$("#tagsPool"),initialize:function(){this.conversationID="";$("#tags").tagsInput({height:"22px",width:"auto",onAddTag:this.onAddTag,onRemoveTag:this.onRemoveTag,autocomplete_url:"Tags/FindMatchingTags",});_.bindAll(this,"render","appendTag","onAddTag","onRemoveTag","getTags")},onAddTag:function(h){var g=new d({Name:h});tagsRep[gSelectedConversationID].add(g);$.getJSON("Tags/AddTagToConversations",{tagName:h,convID:gSelectedConversationID},function(i){console.log(i)})},onRemoveTag:function(i){var g=tagsRep[gSelectedConversationID];var h=_(g.models).select(function(j){return j.get("Name")===i})[0];g.remove(h);$.getJSON("Tags/RemoveTagFromConversation",{tagName:i,convID:gSelectedConversationID},function(j){console.log(j)})},getTags:function(j){var g=$("#tags");g.importTags("");var i=document.getElementById("tagsContainer");this.conversationID=j;if(j in tagsRep){f.stop();this.render()}else{var h=new c();h.bind("reset",this.render);h.fetch({data:{conversationID:j},success:function(){}});tagsRep[j]=h}},render:function(){var h=$("#tags");h.importTags("");var g=this;tagsRep[this.conversationID].each(function(i){g.appendTag(i)})},appendTag:function(g){$("#tags").addTag(g.get("Name"),{callback:false})}});var a=new e();return a};