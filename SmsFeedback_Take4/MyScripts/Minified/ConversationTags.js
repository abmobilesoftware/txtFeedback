"use strict";var tagsRep={};function TagsArea(){var e=Backbone.Model.extend({defaults:{Name:"tag",Description:"description"},idAttribute:"Name"});var d=Backbone.Collection.extend({model:e,url:function(){return"Tags/GetTagsForConversation"}});var c={lines:9,length:5,width:3,radius:3,rotate:0,color:"black",speed:1,trail:60,shadow:true,hwaccel:false,className:"spinner",zIndex:2000000000,top:"auto",left:"auto"};var g=new Spinner(c);var b=$("#messagesAddTagPlaceHolderMessage").val();var f=Backbone.View.extend({el:$("#tagsPool"),initialize:function(){this.conversationID="";$("#tags").tagsInput({height:"22px",width:"auto",onAddTag:this.onAddTag,onRemoveTag:this.onRemoveTag,autocomplete_url:"Tags/FindMatchingTags",defaultText:b,placeholder:b,interactve:true});_.bindAll(this,"render","appendTag","onAddTag","onRemoveTag","getTags")},onAddTag:function(i){var h=new e({Name:i});tagsRep[gSelectedConversationID].add(h);$.getJSON("Tags/AddTagToConversations",{tagName:i,convID:gSelectedConversationID},function(j){})},onRemoveTag:function(j){var h=tagsRep[gSelectedConversationID];var i=_(h.models).select(function(k){return k.get("Name")===j})[0];h.remove(i);$.getJSON("Tags/RemoveTagFromConversation",{tagName:j,convID:gSelectedConversationID},function(k){})},getTags:function(k){var h=$("#tags");h.importTags("");var j=document.getElementById("tagsContainer");this.conversationID=k;if(k in tagsRep){g.stop();this.render()}else{var i=new d();i.bind("reset",this.render);i.fetch({data:{conversationID:k},success:function(){}});tagsRep[k]=i}},render:function(){var i=$("#tags");i.importTags("");var h=this;tagsRep[this.conversationID].each(function(j){h.appendTag(j)})},appendTag:function(h){$("#tags").addTag(h.get("Name"),{callback:false})}});var a=new f();return a};